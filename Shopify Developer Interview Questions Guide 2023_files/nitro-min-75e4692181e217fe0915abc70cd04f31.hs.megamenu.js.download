;(function(e){"use strict";var t=window.MegaMenu||{};t=function(){function t(i,n){var s=this;this.$element=e(i);this.options=e.extend(true,{},t.defaults,n);this._items=e();Object.defineProperties(this,{itemsSelector:{get:function(){return s.options.classMap.hasSubMenu+","+s.options.classMap.hasMegaMenu}},_tempChain:{value:null,writable:true},state:{value:null,writable:true}});this.initialize()}return t}();t.defaults={event:"hover",direction:"horizontal",breakpoint:991,animationIn:false,animationOut:false,rtl:false,hideTimeOut:300,sideBarRatio:1/4,pageContainer:e("body"),classMap:{initialized:".hs-menu-initialized",mobileState:".hs-mobile-state",subMenu:".hs-sub-menu",hasSubMenu:".hs-has-sub-menu",hasSubMenuActive:".hs-sub-menu-opened",megaMenu:".hs-mega-menu",hasMegaMenu:".hs-has-mega-menu",hasMegaMenuActive:".hs-mega-menu-opened"},mobileSpeed:400,mobileEasing:"linear",isMenuOpened:false,beforeOpen:function(){},beforeClose:function(){},afterOpen:function(){},afterClose:function(){}};t.prototype.initialize=function(){var t=this,i=e(window);if(this.options.rtl)this.$element.addClass("hs-rtl");this.$element.addClass(this.options.classMap.initialized.slice(1)).addClass("hs-menu-"+this.options.direction);i.on("resize.HSMegaMenu",function(e){if(t.resizeTimeOutId)clearTimeout(t.resizeTimeOutId);t.resizeTimeOutId=setTimeout(function(){if(window.innerWidth<=t.options.breakpoint&&t.state==="desktop")t.initMobileBehavior();else if(window.innerWidth>t.options.breakpoint&&t.state==="mobile")t.initDesktopBehavior();t.refresh()},50)});if(window.innerWidth>=768){e(document).on("click.HSMegaMenu touchstart.HSMegaMenu","body",function(i){var n=e(i.target).parents(t.itemsSelector);t.closeAll(n.add(e(i.target)))})}i.on("keyup.HSMegaMenu",function(e){if(e.keyCode&&e.keyCode===27){t.closeAll();t.options.isMenuOpened=false}});if(window.innerWidth<=this.options.breakpoint)this.initMobileBehavior();else if(window.innerWidth>this.options.breakpoint)this.initDesktopBehavior();this.smartPositions();return this};t.prototype.smartPositions=function(){var t=this,n=this.$element.find(this.options.classMap.subMenu);n.each(function(n,s){i.smartPosition(e(s),t.options)})};t.prototype.bindEvents=function(){var t=this,i;if(this.options.event==="hover"&&!n()){this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(i){var n=e(this),s=n.parents(t.itemsSelector);if(!n.data("HSMenuItem")){t.initMenuItem(n,t.getType(n))}s=s.add(n);t.closeAll(s);s.each(function(t,i){var n=e(i).data("HSMenuItem");if(n.hideTimeOutId)clearTimeout(n.hideTimeOutId);n.desktopShow()});t._items=t._items.not(s);t._tempChain=s;i.preventDefault();i.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(i){if(!e(this).data("HSMenuItem"))return;var n=e(this),s=n.data("HSMenuItem"),o=e(i.relatedTarget).parents(t.itemsSelector);s.hideTimeOutId=setTimeout(function(){t.closeAll(o)},t.options.hideTimeOut);t._items=t._items.add(t._tempChain);t._tempChain=null;i.preventDefault();i.stopPropagation()}).on("click.HSMegaMenu touchstart.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="click"] > a, '+this.options.classMap.hasSubMenu+'[data-event="click"] > a',function(i){var n=e(this).parent('[data-event="click"]'),s;if(!n.data("HSMenuItem")){t.initMenuItem(n,t.getType(n))}t.closeAll(n.add(n.parents(t.itemsSelector)));s=n.data("HSMenuItem");if(s.isOpened){s.desktopHide()}else{s.desktopShow()}i.preventDefault();i.stopPropagation()})}else{this.$element.on("click.HSMegaMenu",n()?this.options.classMap.hasMegaMenu+" > a, "+this.options.classMap.hasSubMenu+" > a":this.options.classMap.hasMegaMenu+':not([data-event="hover"]) > a,'+this.options.classMap.hasSubMenu+':not([data-event="hover"]) > a',function(i){var n=e(this).parent(),s,o=n.parents(t.itemsSelector);if(!n.data("HSMenuItem")){t.initMenuItem(n,t.getType(n))}t.closeAll(n.add(n.parents(t.itemsSelector)));s=n.addClass("hs-event-prevented").data("HSMenuItem");if(s.isOpened){s.desktopHide()}else{s.desktopShow()}i.preventDefault();i.stopPropagation()});if(!n()){this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(i){var n=e(this),s=n.parents(t.itemsSelector);if(!n.data("HSMenuItem")){t.initMenuItem(n,t.getType(n))}t.closeAll(n.add(s));s.add(n).each(function(t,i){var n=e(i).data("HSMenuItem");if(n.hideTimeOutId)clearTimeout(n.hideTimeOutId);n.desktopShow()});i.preventDefault();i.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(i){var n=e(this),s=n.data("HSMenuItem");s.hideTimeOutId=setTimeout(function(){t.closeAll(e(i.relatedTarget).parents(t.itemsSelector))},t.options.hideTimeOut);i.preventDefault();i.stopPropagation()})}}this.$element.on("keydown.HSMegaMenu",this.options.classMap.hasMegaMenu+" > a,"+this.options.classMap.hasSubMenu+" > a",function(i){var n=e(this),s=n.parent(),o;if(!s.data("HSMenuItem")){t.initMenuItem(s,t.getType(s))}o=s.data("HSMenuItem");if(n.is(":focus")){if(i.keyCode&&i.keyCode===40){i.preventDefault();o.desktopShow();t.options.isMenuOpened=true}if(i.keyCode&&i.keyCode===13){if(t.options.isMenuOpened===true){o.desktopHide();t.options.isMenuOpened=false}else{o.desktopShow();t.options.isMenuOpened=true}}}n.on("focusout",function(){t.options.isMenuOpened=false});o.menu.find("a").on("focusout",function(){setTimeout(function(){if(!o.menu.find("a").is(":focus")){o.desktopHide();t.options.isMenuOpened=false}})})})};t.prototype.initMenuItem=function(t,n){var s=this,o=new i(t,t.children(s.options.classMap[n==="mega-menu"?"megaMenu":"subMenu"]),e.extend(true,{type:n},s.options,t.data()),s.$element);t.data("HSMenuItem",o);this._items=this._items.add(t)};t.prototype.initMobileBehavior=function(){var t=this;this.state="mobile";this.$element.off(".HSMegaMenu").addClass(this.options.classMap.mobileState.slice(1)).on("click.HSMegaMenu",t.options.classMap.hasSubMenu+" > a, "+t.options.classMap.hasMegaMenu+" > a",function(i){var n=e(this).parent(),s;if(!n.data("HSMenuItem")){t.initMenuItem(n,t.getType(n))}t.closeAll(n.parents(t.itemsSelector).add(n));s=n.data("HSMenuItem");if(s.isOpened){s.mobileHide()}else{s.mobileShow()}i.preventDefault();i.stopPropagation()}).find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide()};t.prototype.initDesktopBehavior=function(){this.state="desktop";this.$element.removeClass(this.options.classMap.mobileState.slice(1)).off(".HSMegaMenu").find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide();this.bindEvents()};t.prototype.closeAll=function(t){var i=this;return this._items.not(t&&t.length?t:e()).each(function(t,n){e(n).removeClass("hs-event-prevented").data("HSMenuItem")[i.state==="mobile"?"mobileHide":"desktopHide"]()})};t.prototype.getType=function(e){if(!e||!e.length)return null;return e.hasClass(this.options.classMap.hasSubMenu.slice(1))?"sub-menu":e.hasClass(this.options.classMap.hasMegaMenu.slice(1))?"mega-menu":null};t.prototype.getState=function(){return this.state};t.prototype.refresh=function(){return this._items.add(this._tempChain).each(function(t,i){e(i).data("HSMenuItem")._updateMenuBounds()})};function i(e,t,i,n){var s=this;this.$element=e;this.menu=t;this.options=i;this.$container=n;Object.defineProperties(this,{itemClass:{get:function(){return s.options.type==="mega-menu"?s.options.classMap.hasMegaMenu:s.options.classMap.hasSubMenu}},activeItemClass:{get:function(){return s.options.type==="mega-menu"?s.options.classMap.hasMegaMenuActive:s.options.classMap.hasSubMenuActive}},menuClass:{get:function(){return s.options.type==="mega-menu"?s.options.classMap.megaMenu:s.options.classMap.subMenu}},isOpened:{get:function(){return this.$element.hasClass(this.activeItemClass.slice(1))}}});this.menu.addClass("animated").on("click.HSMegaMenu",function(e){s._updateMenuBounds()});if(this.$element.data("max-width"))this.menu.css("max-width",this.$element.data("max-width"));if(this.$element.data("position"))this.menu.addClass("hs-position-"+this.$element.data("position"));if(this.options.animationOut){this.menu.on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(e){if(s.menu.hasClass(s.options.animationOut)){s.$element.removeClass(s.activeItemClass.slice(1));s.options.afterClose.call(s,s.$element,s.menu)}if(s.menu.hasClass(s.options.animationIn)){s.options.afterOpen.call(s,s.$element,s.menu)}e.stopPropagation();e.preventDefault()})}}i.prototype.desktopShow=function(){if(!this.menu.length)return this;this.$element.addClass(this.activeItemClass.slice(1));this._updateMenuBounds();this.menu.show();if(this.options.direction==="horizontal")this.smartPosition(this.menu,this.options);if(this.options.animationOut){this.menu.removeClass(this.options.animationOut)}else{this.options.afterOpen.call(this,this.$element,this.menu)}if(this.options.animationIn){this.menu.addClass(this.options.animationIn)}return this};i.prototype.desktopHide=function(){var e=this;if(!this.menu.length)return this;this.$element.removeClass(this.activeItemClass.slice(1));this.menu.hide();if(this.options.animationIn){this.menu.removeClass(this.options.animationIn)}if(this.options.animationOut){this.menu.addClass(this.options.animationOut)}else{this.options.afterClose.call(this,this.$element,this.menu)}return this};i.prototype.mobileShow=function(){var e=this;if(!this.menu.length)return this;this.menu.removeClass(this.options.animationIn).removeClass(this.options.animationOut).stop().slideDown({duration:e.options.mobileSpeed,easing:e.options.mobileEasing,complete:function(){e.options.afterOpen.call(e,e.$element,e.menu)}});this.$element.addClass(this.activeItemClass.slice(1));return this};i.prototype.mobileHide=function(){var e=this;if(!this.menu.length)return this;this.menu.stop().slideUp({duration:e.options.mobileSpeed,easing:e.options.mobileEasing,complete:function(){e.options.afterClose.call(e,e.$element,e.menu)}});this.$element.removeClass(this.activeItemClass.slice(1));return this};i.prototype.smartPosition=function(e,t){i.smartPosition(e,t)};i.smartPosition=function(t,i){if(!t&&!t.length)return;var n=e(window);t.removeClass("hs-reversed");if(!i.rtl){if(t.offset().left+t.outerWidth()>window.innerWidth){t.addClass("hs-reversed")}}else{if(t.offset().left<0){t.addClass("hs-reversed")}}};i.prototype._updateMenuBounds=function(){var t="auto";if(this.options.direction==="vertical"&&this.options.type==="mega-menu"){if(this.$container&&this.$container.data("HSMegaMenu").getState()==="desktop"){if(!this.options.pageContainer.length)this.options.pageContainer=e("body");t=this.options.pageContainer.outerWidth()*(1-this.options.sideBarRatio)}else{t="auto"}this.menu.css({"width":t,"height":"auto"});if(this.menu.outerHeight()>this.$container.outerHeight()){return}this.menu.css("height","100%")}};e.fn.HSMegaMenu=function(){var e=this,i=arguments[0],n=Array.prototype.slice.call(arguments,1),s=e.length,o,a;for(o=0;o<s;o++){if(typeof i==="object"||typeof i==="undefined")e[o].MegaMenu=new t(e[o],i);else a=e[o].MegaMenu[i].apply(e[o].MegaMenu,n);if(typeof a!="undefined")return a}return e};function n(){return"ontouchstart"in window}})(jQuery);